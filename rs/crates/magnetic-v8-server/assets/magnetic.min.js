!function(e){var t=self.Magnetic={},n=null,a=null,r=null,i="disconnected",o=[],c={},l={},s="",f=new TextEncoder;function u(t){if(n&&t&&t.root){var a=e.activeElement,r=null;!a||"INPUT"!==a.tagName&&"TEXTAREA"!==a.tagName||(r={el:a,key:a.dataset?a.dataset.key:null,name:a.getAttribute("name"),start:a.selectionStart,end:a.selectionEnd,val:a.value});var i=t.root;if(i.key&&c[i.key]&&c[i.key].parentNode===n?v(c[i.key],i):(n.textContent="",n.appendChild(d(i))),r){var o=r.key?c[r.key]:r.name?n.querySelector("input[name='"+r.name+"'],textarea[name='"+r.name+"']"):null;if(o&&o!==e.activeElement){o.focus(),o.value=r.val;try{o.setSelectionRange(r.start,r.end)}catch(e){}}}}}function d(t){var n=e.createElement(t.tag);if(t.key&&(n.dataset.key=t.key,c[t.key]=n),m(n,t),t.events)for(var a in t.events)n.dataset["a_"+a]=t.events[a];if(null!=t.text&&(n.textContent=t.text),t.children)for(var r=0;r<t.children.length;r++)n.appendChild(d(t.children[r]));return n}function v(e,t){if(m(e,t),t.events)for(var n in t.events)e.dataset["a_"+n]=t.events[n];var a=e.dataset;for(var r in a)if(0===r.indexOf("a_")){var i=r.slice(2);t.events&&i in t.events||delete a[r]}if(t.children)!function(e,t){var n,a,r,i,o=[],l={};for(n=0;n<t.length;n++)(a=t[n]).key&&c[a.key]?(v(r=c[a.key],a),l[a.key]=!0):(r=d(a),a.key&&(l[a.key]=!0)),o.push(r);var s=e.firstChild;for(;s;){var f=s.nextSibling;(i=s.dataset?s.dataset.key:null)&&l[i]&&c[i]===s||(h(s),e.removeChild(s)),s=f}for(n=0;n<o.length;n++)e.childNodes[n]!==o[n]&&e.insertBefore(o[n],e.childNodes[n]||null)}(e,t.children);else if(null!=t.text&&"input"!=t.tag&&"textarea"!=t.tag)e.textContent=t.text;else if(!t.children&&null==t.text&&"input"!=t.tag&&"textarea"!=t.tag)for(;e.firstChild;)h(e.firstChild),e.removeChild(e.firstChild)}function h(e){var t=e.dataset?e.dataset.key:null;t&&c[t]===e&&delete c[t];for(var n=e.firstChild;n;)h(n),n=n.nextSibling}t.status=function(){return i},t._renderers={},t.registerRenderer=function(e,n){t._renderers[e]=n},t.connect=function(o,v){n="string"==typeof v?e.querySelector(v):v,(a=new EventSource(o)).onmessage=function(e){try{var t=e.data;if(r&&r.store){var n=f.encode(t);if(n.length<=16384&&(new Uint8Array(r.memory.buffer).set(n,r.input_ptr()),0===r.store(n.length)))return}else{var a=E(t);if(a===s)return;s=a}u(JSON.parse(t))}catch(e){console.error("[magnetic] SSE error:",e)}},a.addEventListener("delta",function(e){try{var a=JSON.parse(e.data),r=t._renderers[a.k];if(!r)return;var i=r(a.v);if(!i)return;var o=c[a.t]||n.querySelector('[data-key="'+a.t+'"]');if(!o)return;c[a.t]||(c[a.t]=o);var l=d(i);for(o.insertBefore(l,o.firstChild);a.max>0&&o.children.length>a.max;){var s=o.lastElementChild;s&&(h(s),o.removeChild(s))}}catch(e){console.error("[magnetic] delta error:",e)}}),a.onerror=function(){r&&(i="offline")},i="connected",e.addEventListener("click",function(e){var t=g(e);if(t){var n=t.closest("[data-a_click]");n&&(e.preventDefault(),k(n.dataset.a_click,{}))}}),e.addEventListener("submit",function(e){var t=g(e);if(t){var n=t.closest("[data-a_submit]");if(n){e.preventDefault();var a={};new FormData(n).forEach(function(e,t){a[t]=e}),k(n.dataset.a_submit,a),n.querySelectorAll("input").forEach(function(e){e.value=""})}}}),e.addEventListener("input",function(e){var t=g(e);if(t){var n=t.closest("[data-a_input]");if(n){var a=n.dataset.a_input;clearTimeout(l[a]),l[a]=setTimeout(function(){k(a,{value:n.value})},300)}}})},t.disconnect=function(){a&&(a.close(),a=null),i="disconnected"},t._apply=u;var p=/^\s*javascript\s*:/i,y={href:1,src:1,action:1,formaction:1,"xlink:href":1};function m(e,t){if(t.attrs)for(var n in t.attrs){var a=t.attrs[n];y[n]&&p.test(a)||e.setAttribute(n,a)}}function g(e){var t=e.target;return t.closest?t:t.parentElement}function k(e,t){if(0===e.indexOf("navigate:")){var n=e.slice(9);history.pushState({},"",n),e="navigate",t={path:n}}var a=JSON.stringify({action:e,payload:t});fetch("/actions/"+encodeURIComponent(e),{method:"POST",headers:{"Content-Type":"application/json"},body:a}).then(function(e){return e.text()}).then(function(e){if(e&&"{"===e[0]){if(r&&r.store){var t=f.encode(e);t.length<=16384&&(new Uint8Array(r.memory.buffer).set(t,r.input_ptr()),r.store(t.length))}else s=E(e);try{u(JSON.parse(e))}catch(e){}}}).catch(function(){}),"connected"!=i&&o.push(a)}t.send=k;var x={};function E(e){for(var t=2166136261,n=0;n<e.length;n++)t^=e.charCodeAt(n),t=Math.imul(t,16777619);return t}e.addEventListener("mouseenter",function(e){var t=g(e);if(t){var n=t.closest("[data-prefetch]");if(n){var a=n.getAttribute("data-prefetch");a&&!x[a]&&(x[a]=1,fetch(a,{method:"GET",headers:{"X-Prefetch":"1"}}).catch(function(){}))}}},!0),self.addEventListener("popstate",function(){k("navigate",{path:location.pathname+location.search})}),t.loadWasm=function(e){null===r&&(r=0,fetch(e).then(function(e){return e.arrayBuffer()}).then(function(e){return WebAssembly.instantiate(e,{})}).then(function(e){for(r=e.instance.exports;o.length;){var t=JSON.parse(o.shift());k(t.action,t.payload)}}).catch(function(){r=null}))}}(document);